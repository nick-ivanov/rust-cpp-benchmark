# Figure 3: C++ Merge Sort vs Insertion Sort vs Best Hybrid Sort

import matplotlib.pyplot as plt
y = [250, 500, 750, 1000, 1250, 1500, 1750, 2000, 2250, 2500, 2750, 3000, 3250, 3500, 3750, 4000, 4250, 4500, 4750, 5000, 5250, 5500, 5750, 6000, 6250, 6500, 6750, 7000, 7250, 7500, 7750, 8000, 8250, 8500, 8750, 9000, 9250, 9500, 9750, 10000]
p1, = plt.plot(y, [0.000033, 0.000070, 0.000113, 0.000144, 0.000204, 0.000239, 0.000268, 0.000307, 0.000378, 0.000413, 0.000465, 0.000533, 0.000537, 0.000569, 0.000607, 0.000633, 0.000712, 0.000774, 0.000826, 0.000871, 0.000944, 0.000965, 0.001013, 0.001057, 0.001102, 0.001160, 0.001232, 0.001239, 0.001275, 0.001316, 0.001342, 0.001384, 0.001498, 0.001616, 0.001645, 0.001688, 0.001739, 0.001768, 0.001859, 0.002008], label='C++ -O2 Merge Sort', marker='o')
p2, = plt.plot(y, [0.000011, 0.000024, 0.000037, 0.000054, 0.000068, 0.000085, 0.000103, 0.000126, 0.000134, 0.000151, 0.000171, 0.000188, 0.000207, 0.000229, 0.000249, 0.000276, 0.000284, 0.000302, 0.000321, 0.000343, 0.000359, 0.000380, 0.000397, 0.000418, 0.000438, 0.000460, 0.000484, 0.000505, 0.000549, 0.000562, 0.000584, 0.000604, 0.000620, 0.000642, 0.000661, 0.000683, 0.000705, 0.000717, 0.000748, 0.000754], label='C++ -O2 Hybrid Sort K=128', marker='x')
p3, = plt.plot(y, [0.000012, 0.000045, 0.000098, 0.000171, 0.000262, 0.000375, 0.000506, 0.000657, 0.000836, 0.001040, 0.001267, 0.001468, 0.001706, 0.001961, 0.002204, 0.002505, 0.002841, 0.003186, 0.003554, 0.003957, 0.004437, 0.005009, 0.005554, 0.005900, 0.006193, 0.006725, 0.007296, 0.007881, 0.008465, 0.008993, 0.009680, 0.010221, 0.010850, 0.011484, 0.012210, 0.012981, 0.014058, 0.014920, 0.015644, 0.016068], label='C++ -O2 Insertion Sort', marker='*')

plt.legend(handles=[p1, p2, p3], fontsize='14')

plt.ylabel('Average Delay over 10,000 Runs (sec.)', fontsize='14', fontweight='bold')
plt.xlabel('Vector Length (double precision IEEE 754 elements)', fontsize='14', fontweight='bold')
plt.show()